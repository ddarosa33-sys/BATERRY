<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power BT - Battery Monitor</title>
    <!-- Cargando React y Babel desde CDNs confiables -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: white; margin: 0; overflow-x: hidden; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(52, 211, 153, 0.2); }
            50% { box-shadow: 0 0 20px rgba(52, 211, 153, 0.6); }
        }
        .charging-glow { animation: pulse-glow 2s infinite; }
        /* Evitar que se vea el código antes de que Babel lo procese */
        [v-cloak] { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Iconos Inline SVG (para que no dependa de librerías externas que fallen)
        const Icons = {
            Bluetooth: () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m7 7 10 10-5 5V2l5 5L7 17"/></svg>
            ),
            Battery: ({className, size=20}) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="10" x="2" y="7" rx="2" ry="2"/><line x1="22" x2="22" y1="11" y2="13"/></svg>
            ),
            BatteryCharging: ({className, size=20}) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15 7h1a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-1"/><path d="M6 7H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="m11 7-3 5h4l-3 5"/><line x1="22" x2="22" y1="11" y2="13"/></svg>
            ),
            Volume2: ({size=24}) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 5 6 9H2v6h4l5 4V5Z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>
            ),
            Zap: ({size=14, className}) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4 14.71 13.5 3l-2.25 8.29H20L10.5 21l2.25-8.29H4Z"/></svg>
            ),
            Trash: ({size=16}) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
            )
        };

        function App() {
            const [devices, setDevices] = useState([
                { id: '1', name: 'Parlante Principal', battery: 82, isCharging: false, signal: -40 },
                { id: '2', name: 'Auriculares Pro', battery: 18, isCharging: true, signal: -55 }
            ]);
            const [isScanning, setIsScanning] = useState(false);
            const [statusMsg, setStatusMsg] = useState("Sincronizado");

            // Función para simular escaneo (Funciona siempre en GitHub Pages)
            const handleScan = () => {
                setIsScanning(true);
                setStatusMsg("Buscando dispositivos...");
                
                // Intento de Bluetooth Real (solo funciona en HTTPS + Chrome/Edge)
                if (navigator.bluetooth) {
                    console.log("API Bluetooth detectada");
                }

                setTimeout(() => {
                    const newId = Math.random().toString(36).substr(2, 9);
                    const mockDevice = {
                        id: newId,
                        name: `Parlante BT-${Math.floor(Math.random() * 99)}`,
                        battery: Math.floor(Math.random() * 100),
                        isCharging: Math.random() > 0.7,
                        signal: -Math.floor(Math.random() * 40 + 30)
                    };
                    setDevices(prev => [mockDevice, ...prev]);
                    setIsScanning(false);
                    setStatusMsg("Dispositivo encontrado");
                }, 2000);
            };

            const removeDevice = (id) => {
                setDevices(devices.filter(d => d.id !== id));
            };

            return (
                <div className="min-h-screen bg-slate-950 flex flex-col max-w-md mx-auto shadow-2xl border-x border-slate-900 overflow-hidden">
                    
                    {/* Header */}
                    <header className="p-8 pt-12 bg-gradient-to-b from-indigo-900/30 to-transparent">
                        <div className="flex justify-between items-center mb-6">
                            <div>
                                <h1 className="text-2xl font-black italic tracking-tighter uppercase flex items-center gap-2">
                                    <Icons.Bluetooth /> Power BT
                                </h1>
                                <div className="flex items-center gap-2 mt-1">
                                    <div className="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"></div>
                                    <span className="text-[10px] font-black text-indigo-400 tracking-widest uppercase">{statusMsg}</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Contenido Principal */}
                    <main className="flex-1 px-6 space-y-6 overflow-y-auto pb-32">
                        <div className="flex justify-between items-center opacity-60">
                            <h2 className="text-[10px] font-black uppercase tracking-widest flex items-center gap-2">
                                <Icons.Zap size={14} className="text-indigo-500" /> Mis Parlantes
                            </h2>
                            <span className="text-[10px] font-bold uppercase">{devices.length} Activos</span>
                        </div>

                        {devices.length === 0 && (
                            <div className="py-20 text-center border-2 border-dashed border-slate-800 rounded-[2rem]">
                                <p className="text-slate-500 text-xs font-bold">No hay dispositivos vinculados.</p>
                            </div>
                        )}

                        <div className="space-y-4">
                            {devices.map(device => (
                                <div key={device.id} className="bg-slate-900/80 border border-slate-800 p-6 rounded-[2.5rem] transition-all hover:border-indigo-500/50">
                                    <div className="flex justify-between items-start mb-6">
                                        <div className="flex gap-4">
                                            <div className="p-4 bg-indigo-600/10 text-indigo-500 rounded-2xl">
                                                <Icons.Volume2 size={24} />
                                            </div>
                                            <div>
                                                <h3 className="font-black text-white text-lg tracking-tight">{device.name}</h3>
                                                <p className="text-[9px] font-bold text-slate-500 uppercase">Señal: {device.signal} dBm</p>
                                            </div>
                                        </div>
                                        <div className="text-right flex flex-col items-end">
                                            {device.isCharging ? 
                                                <Icons.BatteryCharging className="text-emerald-400 animate-pulse" /> : 
                                                <Icons.Battery className={device.battery < 20 ? 'text-red-500' : 'text-slate-400'} />
                                            }
                                            <p className="text-[10px] font-black text-slate-400 mt-1">{device.battery}%</p>
                                        </div>
                                    </div>

                                    {/* Barra de progreso */}
                                    <div className="w-full h-2.5 bg-slate-800 rounded-full overflow-hidden mb-4">
                                        <div 
                                            className={`h-full rounded-full transition-all duration-1000 ${device.isCharging ? 'bg-emerald-400 charging-glow' : device.battery > 20 ? 'bg-indigo-500' : 'bg-red-500'}`}
                                            style={{ width: `${device.battery}%` }}
                                        />
                                    </div>

                                    <div className="flex justify-between items-center">
                                        <div className="flex items-center gap-2">
                                            {device.isCharging && (
                                                <div className="flex items-center gap-1.5 bg-emerald-500/10 px-3 py-1 rounded-full border border-emerald-500/20">
                                                    <Icons.Zap size={10} className="text-emerald-400" />
                                                    <span className="text-[9px] font-black text-emerald-400 uppercase tracking-tighter">Cargando</span>
                                                </div>
                                            )}
                                        </div>
                                        <button onClick={() => removeDevice(device.id)} className="p-2 text-slate-700 hover:text-red-500 transition-colors">
                                            <Icons.Trash size={18} />
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <button 
                            onClick={handleScan}
                            disabled={isScanning}
                            className="w-full bg-indigo-600 hover:bg-indigo-500 text-white p-5 rounded-[2rem] font-black text-sm flex items-center justify-center gap-3 active:scale-95 transition-all shadow-xl shadow-indigo-950/40 disabled:opacity-50"
                        >
                            {isScanning ? <span className="animate-spin text-xl">◌</span> : <Icons.Bluetooth />}
                            {isScanning ? "BUSCANDO..." : "CONECTAR PARLANTE"}
                        </button>
                    </main>

                    {/* Footer Nav */}
                    <footer className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-slate-950/90 backdrop-blur-xl border-t border-slate-800 p-6 flex justify-around items-center z-50">
                        <div className="text-indigo-500 opacity-100"><Icons.Volume2 /></div>
                        <div 
                            onClick={handleScan}
                            className="w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center -mt-12 border-4 border-slate-950 text-white shadow-2xl active:scale-90 transition-transform cursor-pointer"
                        >
                            <Icons.Bluetooth />
                        </div>
                        <div className="text-slate-600 opacity-50"><Icons.Zap size={24} /></div>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

